services:
  qdrant:
    image: qdrant/qdrant:v1.9.0
    container_name: rag_arabic_chatbot-qdrant
    ports:
      - "6333:6333"
    volumes:
      - ./data/qdrant_storage:/qdrant/storage

  ragapp:
    build: .
    image: rag_arabic_chatbot-ragapp
    environment:
      QDRANT_URL: http://qdrant:6333
      EMB_MODEL: abdulrahman-nuzha/intfloat-multilingual-e5-large-arabic-fp16
      GEN_MODEL: aubmindlab/aragpt2-base
    volumes:
      - ./data:/app/data
    depends_on:
      - qdrant
    stdin_open: true
    tty: true

  chat:
    image: rag_arabic_chatbot-ragapp
    command: python -m ragchat.chat_cli
    environment:
      QDRANT_URL: http://qdrant:6333
      EMB_MODEL: abdulrahman-nuzha/intfloat-multilingual-e5-large-arabic-fp16
      GEN_MODEL: aubmindlab/aragpt2-base
    volumes:
      - ./data:/app/data
    depends_on:
      - qdrant
    stdin_open: true
    tty: true

  evaluate:
    image: rag_arabic_chatbot-ragapp
    command: python -m ragchat.evaluate_cli --n 50
    environment:
      QDRANT_URL: http://qdrant:6333
      EMB_MODEL: abdulrahman-nuzha/intfloat-multilingual-e5-large-arabic-fp16
      GEN_MODEL: aubmindlab/aragpt2-base
    volumes:
      - ./data:/app/data
    depends_on:
      - qdrant
